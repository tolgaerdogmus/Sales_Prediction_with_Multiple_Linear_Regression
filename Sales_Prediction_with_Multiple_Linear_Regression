{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "58345d8b",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:04.561785Z",
     "iopub.status.busy": "2024-06-30T17:33:04.561416Z",
     "iopub.status.idle": "2024-06-30T17:33:07.520994Z",
     "shell.execute_reply": "2024-06-30T17:33:07.519749Z"
    },
    "papermill": {
     "duration": 2.970707,
     "end_time": "2024-06-30T17:33:07.523631",
     "exception": false,
     "start_time": "2024-06-30T17:33:04.552924",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/advertising/advertising.csv\n"
     ]
    }
   ],
   "source": [
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.metrics import mean_squared_error, mean_absolute_error\n",
    "from sklearn.model_selection import train_test_split, cross_val_score\n",
    "\n",
    "# Settings\n",
    "pd.set_option(\"display.float_format\", lambda x: \"%.2f\" % x)\n",
    "\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b2bd6646",
   "metadata": {
    "papermill": {
     "duration": 0.006137,
     "end_time": "2024-06-30T17:33:07.535866",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.529729",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Multiple Linear Regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "68affb10",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.549775Z",
     "iopub.status.busy": "2024-06-30T17:33:07.549112Z",
     "iopub.status.idle": "2024-06-30T17:33:07.568116Z",
     "shell.execute_reply": "2024-06-30T17:33:07.566866Z"
    },
    "papermill": {
     "duration": 0.029167,
     "end_time": "2024-06-30T17:33:07.571046",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.541879",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df = pd.read_csv(\"/kaggle/input/advertising/advertising.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "5995a244",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.584740Z",
     "iopub.status.busy": "2024-06-30T17:33:07.584351Z",
     "iopub.status.idle": "2024-06-30T17:33:07.601387Z",
     "shell.execute_reply": "2024-06-30T17:33:07.600144Z"
    },
    "papermill": {
     "duration": 0.026749,
     "end_time": "2024-06-30T17:33:07.604011",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.577262",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Sales bağımlı değişkenini düşürüp diğer tüm bağımlı değişkenleri X e ata.\n",
    "X = df.drop(\"sales\", axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "12573957",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.618297Z",
     "iopub.status.busy": "2024-06-30T17:33:07.617893Z",
     "iopub.status.idle": "2024-06-30T17:33:07.625734Z",
     "shell.execute_reply": "2024-06-30T17:33:07.624600Z"
    },
    "papermill": {
     "duration": 0.018015,
     "end_time": "2024-06-30T17:33:07.628407",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.610392",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Bağımlı değişkeni de y ye ata\n",
    "y = df[[\"sales\"]]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "256cdcf0",
   "metadata": {
    "papermill": {
     "duration": 0.005515,
     "end_time": "2024-06-30T17:33:07.640076",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.634561",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Model "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "bb81fc57",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.654380Z",
     "iopub.status.busy": "2024-06-30T17:33:07.653119Z",
     "iopub.status.idle": "2024-06-30T17:33:07.662769Z",
     "shell.execute_reply": "2024-06-30T17:33:07.661849Z"
    },
    "papermill": {
     "duration": 0.019043,
     "end_time": "2024-06-30T17:33:07.665002",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.645959",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "e09ada13",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.678547Z",
     "iopub.status.busy": "2024-06-30T17:33:07.678161Z",
     "iopub.status.idle": "2024-06-30T17:33:07.686087Z",
     "shell.execute_reply": "2024-06-30T17:33:07.685029Z"
    },
    "papermill": {
     "duration": 0.017424,
     "end_time": "2024-06-30T17:33:07.688341",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.670917",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(40, 1)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_test.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "3f91119d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.702052Z",
     "iopub.status.busy": "2024-06-30T17:33:07.701654Z",
     "iopub.status.idle": "2024-06-30T17:33:07.709881Z",
     "shell.execute_reply": "2024-06-30T17:33:07.708505Z"
    },
    "papermill": {
     "duration": 0.01809,
     "end_time": "2024-06-30T17:33:07.712499",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.694409",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(160, 1)"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "55af26f6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.726742Z",
     "iopub.status.busy": "2024-06-30T17:33:07.726321Z",
     "iopub.status.idle": "2024-06-30T17:33:07.755562Z",
     "shell.execute_reply": "2024-06-30T17:33:07.754270Z"
    },
    "papermill": {
     "duration": 0.039123,
     "end_time": "2024-06-30T17:33:07.758165",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.719042",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "reg_model = LinearRegression().fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "18cd31d0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.772301Z",
     "iopub.status.busy": "2024-06-30T17:33:07.771900Z",
     "iopub.status.idle": "2024-06-30T17:33:07.778961Z",
     "shell.execute_reply": "2024-06-30T17:33:07.777839Z"
    },
    "papermill": {
     "duration": 0.016752,
     "end_time": "2024-06-30T17:33:07.781225",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.764473",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([2.90794702])"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# sabit (b - bias)\n",
    "reg_model.intercept_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "401bbaaf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.795449Z",
     "iopub.status.busy": "2024-06-30T17:33:07.795068Z",
     "iopub.status.idle": "2024-06-30T17:33:07.801954Z",
     "shell.execute_reply": "2024-06-30T17:33:07.800720Z"
    },
    "papermill": {
     "duration": 0.016583,
     "end_time": "2024-06-30T17:33:07.804208",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.787625",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.0468431 , 0.17854434, 0.00258619]])"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# coefficients (w - weights)\n",
    "reg_model.coef_"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f5af9606",
   "metadata": {
    "papermill": {
     "duration": 0.006132,
     "end_time": "2024-06-30T17:33:07.816796",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.810664",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Prediction "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3c521020",
   "metadata": {
    "papermill": {
     "duration": 0.005866,
     "end_time": "2024-06-30T17:33:07.829095",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.823229",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Aşağıdaki gözlem bdeğerlerine göre satışın beklenen değeri nedir?\n",
    "\n",
    "TV: 30\n",
    "radio: 10\n",
    "newspaper: 40"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9b20ae40",
   "metadata": {
    "papermill": {
     "duration": 0.00611,
     "end_time": "2024-06-30T17:33:07.841871",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.835761",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "sales = 2.90 + TV * 0.04 + radio * 0.17 + newspaper * 0.002"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "64bc5dde",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.856657Z",
     "iopub.status.busy": "2024-06-30T17:33:07.856290Z",
     "iopub.status.idle": "2024-06-30T17:33:07.869398Z",
     "shell.execute_reply": "2024-06-30T17:33:07.868025Z"
    },
    "papermill": {
     "duration": 0.023106,
     "end_time": "2024-06-30T17:33:07.871902",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.848796",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.10/site-packages/sklearn/base.py:439: UserWarning: X does not have valid feature names, but LinearRegression was fitted with feature names\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([[6.202131]])"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# x1, x2, x3 = 30, 10, 40\n",
    "# b = 2.90794702\n",
    "# w1, w2, w3 = 0.0468431 , 0.17854434, 0.00258619\n",
    "#y_hat = b + w1*x1 + w2*x2 + w3*x3\n",
    "\n",
    "yeni_xler = [[30], [10], [40]]\n",
    "yeni_xler = pd.DataFrame(yeni_xler).T\n",
    "\n",
    "reg_model.predict(yeni_xler)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "85886111",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.886882Z",
     "iopub.status.busy": "2024-06-30T17:33:07.886487Z",
     "iopub.status.idle": "2024-06-30T17:33:07.893907Z",
     "shell.execute_reply": "2024-06-30T17:33:07.892900Z"
    },
    "papermill": {
     "duration": 0.017557,
     "end_time": "2024-06-30T17:33:07.896105",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.878548",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4.3132401161261456"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# x = 30\n",
    "# b = 2.90794702\n",
    "# w = 0.0468431\n",
    "# y_hat = b + w*x\n",
    "# y_hat = 2.90794702 + 0.0468431*30\n",
    "reg_model.intercept_[0] + reg_model.coef_[0][0]*30\n",
    "\n",
    "# TV 30 için satışlar: \n",
    "# y_hat = 4.3132401161261456"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "fdf77139",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.911357Z",
     "iopub.status.busy": "2024-06-30T17:33:07.910958Z",
     "iopub.status.idle": "2024-06-30T17:33:07.918212Z",
     "shell.execute_reply": "2024-06-30T17:33:07.916985Z"
    },
    "papermill": {
     "duration": 0.017732,
     "end_time": "2024-06-30T17:33:07.920690",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.902958",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4.693390458905194"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# x = 10\n",
    "# b = 2.90794702\n",
    "# w = 0.17854434\n",
    "# y_hat = 2.90794702 + 0.17854434*10\n",
    "reg_model.intercept_[0] + reg_model.coef_[0][1]*10\n",
    "\n",
    "# radio 10 için satışlar:\n",
    "# y_hat = 4.693390458905194"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "15fe7b8c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.936616Z",
     "iopub.status.busy": "2024-06-30T17:33:07.936200Z",
     "iopub.status.idle": "2024-06-30T17:33:07.943487Z",
     "shell.execute_reply": "2024-06-30T17:33:07.942386Z"
    },
    "papermill": {
     "duration": 0.01774,
     "end_time": "2024-06-30T17:33:07.945764",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.928024",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3.011394464575993"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# x = 40\n",
    "# b = 2.90794702\n",
    "# w = 0.00258619\n",
    "# y_hat = b + w*x\n",
    "# y_hat = 2.90794702 + 0.00258619*40\n",
    "reg_model.intercept_[0] + reg_model.coef_[0][2]*40\n",
    "\n",
    "# newspaper 10 için satışlar:\n",
    "# y_hat = 3.011394464575993\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d4094446",
   "metadata": {
    "papermill": {
     "duration": 0.006646,
     "end_time": "2024-06-30T17:33:07.959448",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.952802",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Prediction Success Evaluation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "2002a19e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:07.975806Z",
     "iopub.status.busy": "2024-06-30T17:33:07.975372Z",
     "iopub.status.idle": "2024-06-30T17:33:07.986973Z",
     "shell.execute_reply": "2024-06-30T17:33:07.985850Z"
    },
    "papermill": {
     "duration": 0.022817,
     "end_time": "2024-06-30T17:33:07.989779",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.966962",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.736902590147092"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Train RMSE\n",
    "y_pred = reg_model.predict(X_train)\n",
    "np.sqrt(mean_squared_error(y_train, y_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "679ab8e0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:08.006196Z",
     "iopub.status.busy": "2024-06-30T17:33:08.005833Z",
     "iopub.status.idle": "2024-06-30T17:33:08.016767Z",
     "shell.execute_reply": "2024-06-30T17:33:08.015656Z"
    },
    "papermill": {
     "duration": 0.022223,
     "end_time": "2024-06-30T17:33:08.019259",
     "exception": false,
     "start_time": "2024-06-30T17:33:07.997036",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8959372632325174"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Train RSQUARE\n",
    "reg_model.score(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "87cbc9d2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:08.036221Z",
     "iopub.status.busy": "2024-06-30T17:33:08.035868Z",
     "iopub.status.idle": "2024-06-30T17:33:08.047062Z",
     "shell.execute_reply": "2024-06-30T17:33:08.045610Z"
    },
    "papermill": {
     "duration": 0.022314,
     "end_time": "2024-06-30T17:33:08.049174",
     "exception": false,
     "start_time": "2024-06-30T17:33:08.026860",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.4113417558581587"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Test RMSE\n",
    "y_pred = reg_model.predict(X_test)\n",
    "np.sqrt(mean_squared_error(y_test, y_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "5a2be08e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:08.066362Z",
     "iopub.status.busy": "2024-06-30T17:33:08.065216Z",
     "iopub.status.idle": "2024-06-30T17:33:08.075939Z",
     "shell.execute_reply": "2024-06-30T17:33:08.074690Z"
    },
    "papermill": {
     "duration": 0.021498,
     "end_time": "2024-06-30T17:33:08.078099",
     "exception": false,
     "start_time": "2024-06-30T17:33:08.056601",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8927605914615384"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Test RSQUARE\n",
    "reg_model.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "bc2b1b3a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-30T17:33:08.094330Z",
     "iopub.status.busy": "2024-06-30T17:33:08.093950Z",
     "iopub.status.idle": "2024-06-30T17:33:08.164065Z",
     "shell.execute_reply": "2024-06-30T17:33:08.162850Z"
    },
    "papermill": {
     "duration": 0.081066,
     "end_time": "2024-06-30T17:33:08.166511",
     "exception": false,
     "start_time": "2024-06-30T17:33:08.085445",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.6913531708051797"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 10 Fold Cross Validation RMSE\n",
    "# Veriseti küçük ise bu daha güvenilir, kullanışlıdır\n",
    "\n",
    "np.mean(np.sqrt(-cross_val_score(reg_model, X, y, cv=10, scoring=\"neg_mean_squared_error\")))"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 5309605,
     "sourceId": 8825252,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30732,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 7.264108,
   "end_time": "2024-06-30T17:33:08.796220",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-06-30T17:33:01.532112",
   "version": "2.5.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
